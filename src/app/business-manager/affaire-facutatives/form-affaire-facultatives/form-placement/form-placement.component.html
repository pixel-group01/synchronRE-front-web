<div class="placement-container">
    <form name="placement" [ngBusy]="{
        busy: busySave,
        message: 'Veuillez patienter ...',
        backdrop: false
      }">

        <div class="row">
            <div class="col-12 mb-3">
                <fieldset>
                    <legend>
                        Informations sur l'affaire
                    </legend>
                    <div>
                        <app-details-information-identification></app-details-information-identification>
                    </div>
                </fieldset>
            </div>
        </div>


        <div class="row" *ngIf="!isDetails">

            <div class="col-12 mt-3 mb-3" >
                <fieldset>
                    <legend>
                        Nouveau placement
                    </legend>

                    <div>
                        <div class="row">
                            <div class="col-md-3 col-xs-12 mb-3">
                                <label>Cessionnaire :
                                    <span class="required_champs">*</span>
                                </label>
    
                                  <ng-select [(ngModel)]="itemToSave.cesId" id="cesId" name="cesId">
                                          <ng-option *ngFor="let cessionaire of listeCessionnaire" [value]="cessionaire?.cesId">{{cessionaire.cesNom}}</ng-option>
                                  </ng-select>
    
                                <!-- <input class="form-control custom-input" [(ngModel)]="itemToSavePlacement" placeholder="Filiale" autocomplete="off"
                                    name="repCapital" mask="separator" type="text" /> -->
                            </div>
    
                            <div class="col-md-3 col-xs-12 mb-3">
                                <label>Interlocuteur:<span class="required_champs">*</span>
                                </label>
                                <input class="form-control custom-input" placeholder="Interlocuteur" autocomplete="off" name="repInterlocuteur"
                                    name="interlocuteur" [(ngModel)]="itemToSave.repInterlocuteur" type="text" />
                            </div>
    
                            <div class="col-md-2 col-xs-12 mb-3">
                                <label>Capital:<span class="required_champs">*</span>
                                </label>
                                <input class="form-control custom-input" mask="separator" placeholder="Capital" autocomplete="off"
                                    name="capitalRep" type="text"  [(ngModel)]="itemToSave.repCapital" name="repCapital"  (keyup)="getRepartionByCapital(itemToSave)" />
                            </div>
    
                            <div class="col-md-1 col-xs-12 mb-3">
                                <label>Part:<span class="required_champs">*</span>
                                </label>
                                <input class="form-control custom-input" placeholder="Taux" autocomplete="off" (keyup)="getRepartionByTaux(itemToSave)"
                                    name="repPart" mask="separator" type="text"  [(ngModel)]="itemToSave.repTaux" name="repTaux"  />
                            </div>
 
                          
    
                            <div class="col-md-1 col-xs-12 mb-3">
                                <label>SC/C:<span class="required_champs">*</span>
                                </label>
                                <input class="form-control custom-input" placeholder="Taux" autocomplete="off"
                                    name="repSousCommission" type="text"  mask="separator" [(ngModel)]="itemToSave.repSousCommission" name="repSousCommission" />
                            </div>

                            <div class="col-md-1 col-xs-12 mb-3">
                                <label>Taux C.C:<span class="required_champs">*</span>
                                </label>
                                <input class="form-control custom-input" placeholder="Taux Court" autocomplete="off"
                                    name="repTauxComCourt" mask="separator" type="text"  [(ngModel)]="itemToSave.repTauxComCourt" name="repTauxComCourt"  />
                            </div>
    
                            <div class="col-md-1 col-xs-12 mb-3">
                                <button class="btn btn-xs btn-default btn-add" type="button" (click)="confirmSaveItem()"> Ajouter </button>
                            </div>
                        </div>
                    </div>
                   
                </fieldset>
            </div>

        </div>

        <div class="row">

            <div class="col-12 mb-3 mt-3 table-responsive">
                <fieldset>
                    <!-- <legend>
                        Liste des placements
                    </legend> -->

                    <div class="col-12 mt-3 table-responsive">
                        <table class="table table-condensed">
                            <thead>
                                <tr>
                                    <th colspan="8" class="text-align-center"> <b>Liste des placements</b> </th>
                                </tr>
                                <tr class="custom-table-head">
                                    <th>#</th>
                                    <th>Cessionnaire</th>
                                    <th>Interlocuteur</th>
                                    <th>Capital</th>
                                    <th>Part(%)</th>
                                    <th>Taux Com. court</th>
                                    <th>S/C</th>
                                    <th style="text-align: center;"  *ngIf="!isDetails">Action</th>
                                </tr>
                            </thead>

                            <tbody>
                                <tr *ngFor="let repart of listeRepartitions; let i = index">
                                    <td>{{i+1}}</td>
                                    <td>{{repart?.cesNom}}</td>
                                    <td>{{repart?.repInterlocuteur}}</td>
                                    <td>{{repart?.repCapital | moneyFormat}}</td>
                                    <td>{{repart?.repTaux}}</td>
                                    <td>{{repart?.repTauxComCourt | moneyFormat}}</td>
                                    <td>{{repart?.repSousCommission | moneyFormat}}</td>
                                    <td style="text-align: center;" *ngIf="!isDetails">
                                      
                                        <a title="Imprimer" style="color: rgb(240, 180, 29);cursor: pointer;" (click)="getReportPlacement(repart.repId)">
                                            <i class="fa fa-print"></i>
                                        </a>&nbsp;&nbsp;

                                        <a title="Supprimer" (click)="confirmDeletePlacement(repart)" style="color: red;cursor: pointer">
                                            <i class="fa fa-trash"></i>
                                        </a>
                                    </td>
                                </tr>

                                <tr *ngIf="!listeRepartitions || listeRepartitions.length == 0">
                                    <td colspan="8" class="text-align-center"> Aucune donnée disponible</td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                </fieldset>
            </div>
        </div>

        <div class="custom-btn-save-manager">
            <button type="button" class="btn btn-md btn-cancel pull-right" (click)="gotoPreviousStep()"  *ngIf="isWizardProcess && !isDetails"> 
                Précedent
            </button>
        </div>

    </form>
</div>