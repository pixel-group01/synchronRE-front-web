<div class="body table-responsive" [ngBusy]="{
    busy: busyGet,
    message: 'Veuillez patienter ...',
    backdrop: false
  }">
  <table class="table table-condensed table-striped table-hover">
    <thead> 
      <tr>
        <th colspan="14">
          <div class="row mt-4">
            <div class="col-md-3 col-xs-12 col-sm-12">
              <label>N° Affaire : </label>
              <input [(ngModel)]="itemToSearch.libelle" class="form-control custom-input pull-left"
              placeholder="Rechercher ..."  />
             <!-- <ng-select [(ngModel)]="itemToSearch.cedenteId" (change)="currentPage = 1; getItems()"
                [readonly]="user?.cedId" id="cedenteId">
                <ng-option *ngFor="let cedente of listeCedente" [value]="cedente?.cedId">{{ cedente.cedNomFiliale
                  }}</ng-option>
              </ng-select> -->
            </div>

            <div class="col-md-3 col-xs-12 col-sm-12">
              <label>Date de survenance : </label>
              <input [(ngModel)]="itemToSearch.libelle" class="form-control custom-input pull-left"
              placeholder="Rechercher ..."  />
              <!-- <ng-select [(ngModel)]="itemToSearch.exeCode" (change)="currentPage = 1; getItems()" id="exeCode">
                <ng-option *ngFor="let exercice of listeExercices" [value]="exercice?.exeCode">{{ exercice.exeLibelle
                  }}</ng-option>
              </ng-select> -->
            </div>

            <div class="col-md-4 col-xs-12 col-sm-12">
              <label>Date de declaration : </label>
              <input [(ngModel)]="itemToSearch.libelle" class="form-control custom-input pull-left"
                placeholder="Rechercher ..."  />
            </div>
          </div>
        </th>
      </tr>

      <tr class="custom-table-head">
        <th class="txt-align-center-counter-row">
          <a (click)="currentPage = 1; getSinistre()" title="Actualiser">
            <i class="fa fa-redo-alt"></i></a>&nbsp;&nbsp; #
        </th>
        <th>N° Affaire</th>
        <th>Montant</th>
        <th>Date de survenance</th>
        <th>Date de declaration</th>
        <th>Montant honoraire</th>
        <th class="txt-align-center">Actions</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let item of items; let indice = index">
        <td class="txt-align-center">
          {{ getExactlyNumberRow(this.currentPage, indice) }}
        </td>
        <td>{{ item?.affCode }}</td>
        <td>{{ item?.sinMontant100 }}</td>
        <td>{{ item?.sinDateSurvenance }}</td>
        <td>{{ item?.sinDateDeclaration }}</td>
        <td>{{ item?.sinMontant100 }}</td>
        <!-- <td>{{ item?.affActivite }}</td> -->
        <td class="custom-width-td-action">
          <div class="custom-td-action">
            <div ngbDropdown class="d-inline-block">
              <button type="button" class="btn btn-custom-action-dropdown" id="action" ngbDropdownToggle>
                Actions
              </button>
                <div ngbDropdownMenu aria-labelledby="action" class="dropdown-validation-plainte">
                  <button
                  ngbDropdownItem
                >
                  <i class="fa fa-list" (click)="openModal(templateSinistre,item)"></i>&nbsp;Détails sinistre
                </button>
                  <button ngbDropdownItem (click)="openModal(templateSinistre,item)">
                    <i class="fa fa-edit"></i>&nbsp;Modifier sinistre
                  </button>
  
                  <button ngbDropdownItem >
                    <i class="fa fa-share"></i>&nbsp;Transmettre
                  </button>
  
                  <button ngbDropdownItem >
                  <i class="fa fa-list" (click)="openModal(templateSinistre,item)"></i>&nbsp;Historique sinistre
                </button>
                <button ngbDropdownItem >
                  <i class="fa fa-trash"></i>&nbsp;Supprimer sinistre
                </button>
              </div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>

    <tfoot>
      <tr *ngIf="items && items.length > 0">
        <td colspan="14">
          <div class="row pagination-part">
            <div class="col-md-9" style="text-align: center">
              <pagination [boundaryLinks]="true" [itemsPerPage]="itemsPerPage" [totalItems]="totalItems"
                [(ngModel)]="currentPage" class="pagination-sm" previousText="&lsaquo;" nextText="&rsaquo;"
                firstText="&laquo;" lastText="&raquo;" (pageChanged)="pageChanged($event)"></pagination>
            </div>

            <div class="col-md-3">
              <div class="paginator-per-page">
                <app-element-by-page-paginator (paginationChange)="changePaginationSize($event)"
                  [defaultItemPerPage]="itemsPerPage"></app-element-by-page-paginator>

                <span class="span_total_entree pull-right">Total : {{ totalItems }}</span>
              </div>
            </div>
          </div>
        </td>
      </tr>

      <tr *ngIf="!items || items.length == 0">
        <td colspan="14">
          <div class="col-md-12 txt-align-center">
            Aucune données disponible
          </div>
        </td>
      </tr>
    </tfoot>
  </table>
</div>

<!-- Enregistrement template -->
<ng-template #templateSinistre>
    <div class="modal-header">
        <h4 class="modal-title pull-left">
            Ajout d'un nouveau sinistre 
        </h4>

        <button mat-icon-button class="pull-right" (click)="closeFormModal()" aria-label="Close dialog">
            <mat-icon>close</mat-icon>
        </button>
    </div>
    <div class="modal-body p-4">
        <app-form-sinistre (closeModal)="closeFormModal($event)"></app-form-sinistre>
    </div>
</ng-template>