<div class="container-form-user">
  <ng-container>
    <form
      class="m-1 mt-3"
      [formGroup]="userForm"
      (ngSubmit)="confirmSaveItem()"
    >
      <div
        [ngBusy]="{
          busy: busySuscription,
          message: 'Veuillez patienter ...',
          backdrop: false
        }"
      >
        <div class="row">
          <!-- Partie de droite -->
          <div class="col-12">
            <fieldset>
              <legend>Informations de l'utilisateur</legend>

              <div class="p-1">
                <div class="col-12 mb-3">
                  <div class="col-12 mb-3">
                    <label
                      >Type utilisateur :
                      <span class="required_champs">*</span>
                    </label>

                    <select
                      name="typeUser"
                      class="form-select"
                      formControlName="typeUser"
                    >
                      <option value=""></option>
                      <option value="Cendante">Cedante</option>
                      <option value="Coursier">Coursier</option>
                    </select>
                  </div>
                </div>

                <div
                  class="col-12 mb-3"
                  *ngIf="
                    getFormFiledsValue('typeUser') &&
                    getFormFiledsValue('typeUser')?.value?.toLowerCase() ===
                      'cendante'
                  "
                >
                  <label
                    >Cédante :
                    <span class="required_champs">*</span>
                  </label>

                  <ng-select formControlName="cedId" id="cedId">
                    <ng-option
                      *ngFor="let cedente of listeCedente"
                      [value]="cedente?.cedId"
                      >{{ cedente.cedNomFiliale }}</ng-option
                    >
                  </ng-select>
                </div>

                <div class="col-12 mb-3">
                  <label
                    >Nom :
                    <span class="required_champs">*</span>
                  </label>
                  <input
                    class="form-control custom-input"
                    placeholder="Nom"
                    autocomplete="off"
                    formControlName="lastName"
                    name="lastName"
                    [class.errorInputForm]="
                      getFormFiledsValue('lastName')?.invalid &&
                      getFormFiledsValue('lastName')?.touched
                    "
                    type="text"
                  />

                  <small
                    class="text-danger"
                    *ngIf="(getFormFiledsValue('lastName')?.dirty || getFormFiledsValue('lastName')?.touched) && getFormFiledsValue('lastName')?.invalid && getFormFiledsValue('lastName')?.errors?.['required']"
                  >
                    Ce champ est obligatoire
                  </small>
                </div>

                <div class="col-12 mb-3">
                  <label
                    >Prénoms :
                    <span class="required_champs">*</span>
                  </label>
                  <input
                    class="form-control custom-input"
                    placeholder="Prénoms"
                    autocomplete="off"
                    formControlName="firstName"
                    name="firstName"
                    [class.errorInputForm]="
                      getFormFiledsValue('firstName')?.invalid &&
                      getFormFiledsValue('firstName')?.touched
                    "
                    type="text"
                  />
                  <small
                    class="text-danger"
                    *ngIf="(getFormFiledsValue('firstName')?.dirty || getFormFiledsValue('firstName')?.touched) && getFormFiledsValue('firstName')?.invalid && getFormFiledsValue('firstName')?.errors?.['required']"
                  >
                    Ce champ est obligatoire
                  </small>
                </div>

                <div class="col-12 mb-3">
                  <label
                    >Email :
                    <span class="required_champs">*</span>
                  </label>
                  <input
                    class="form-control custom-input"
                    placeholder="Email"
                    autocomplete="off"
                    formControlName="email"
                    name="email"
                    [class.errorInputForm]="
                      getFormFiledsValue('email')?.invalid &&
                      getFormFiledsValue('email')?.touched
                    "
                    type="text"
                  />
                  <small
                    class="text-danger"
                    *ngIf="(getFormFiledsValue('email')?.dirty || getFormFiledsValue('email')?.touched) && getFormFiledsValue('email')?.invalid && getFormFiledsValue('email')?.errors?.['required']"
                  >
                    Ce champ est obligatoire
                  </small>
                </div>

                <div class="col-12 mb-3">
                  <label
                    >Téléphone :
                    <span class="required_champs">*</span>
                  </label>
                  <input
                    class="form-control custom-input"
                    placeholder="Téléphone"
                    autocomplete="off"
                    formControlName="tel"
                    name="tel"
                    [class.errorInputForm]="
                      getFormFiledsValue('tel')?.invalid &&
                      getFormFiledsValue('tel')?.touched
                    "
                    type="text"
                  />
                  <small
                    class="text-danger"
                    *ngIf="(getFormFiledsValue('tel')?.dirty || getFormFiledsValue('tel')?.touched) && getFormFiledsValue('tel')?.invalid && getFormFiledsValue('tel')?.errors?.['required']"
                  >
                    Ce champ est obligatoire
                  </small>
                </div>
              </div>
            </fieldset>
          </div>
          <!-- Partie de gauche -->
        </div>

        <div class="custom-btn-save-manager">
          <button
            type="submit"
            class="btn btn-md custom_btn_primary pull-right"
            [disabled]="!userForm.valid"
          >
            {{ !itemToUpdate ? "Enregistrer" : "Modifier" }}
          </button>

          <button
            type="button"
            class="btn btn-md btn-cancel pull-right"
            (click)="closeModalUser()"
          >
            Annuler
          </button>
        </div>
      </div>
    </form>
  </ng-container>
</div>
